# Platform configuration for this application
# Generated by Backstage scaffolder
# DO NOT edit manually - managed via GitOps

app:
  name: ${{ values.name }}
  namespace: ${{ values.appNamespace }}
  description: ${{ values.description }}
  owner: ${{ values.owner }}

build:
  arch: ${{ values.arch }}
  platforms: {% if values.arch == 'arm64' %}${{ values.buildPlatformArm64 }}{% elif values.arch == 'amd64' %}${{ values.buildPlatformAmd64 }}{% else %}${{ values.buildPlatformMulti }}{% endif %}
  ecrRepository: ${{ values.ciEcrRepoPrefix }}${{ values.name }}
  tagStrategy: ${{ values.ciImageTagStrategy }}

deployment:
  replicas: 1
  exposePublic: ${{ values.exposePublic }}
  scheduling:
{% if values.arch == 'arm64' %}
    nodeSelector:
      ${{ values.schedulingArchLabelKey }}: ${{ values.schedulingArmValue }}
{% elif values.arch == 'amd64' %}
    nodeSelector:
      ${{ values.schedulingArchLabelKey }}: ${{ values.schedulingAmdValue }}
{% else %}
    # Multi-arch: no nodeSelector, let scheduler choose
    nodeSelector: {}
{% endif %}

platform:
  cluster: ${{ values.clusterName }}
  region: ${{ values.awsRegion }}
  domain: ${{ values.domain }}
